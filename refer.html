<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Refer & Earn – StichStory</title>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f8f3ed;
      color: #2e294e;
      padding: 2rem;
      max-width: 700px;
      margin: 0 auto;
    }
    h1 {
      font-family: 'Cormorant Garamond', serif;
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .form-group { margin-bottom: 1.2rem; }
    label { display: block; margin-bottom: 0.4rem; font-weight: 500; }
    input, textarea {
      width: 100%;
      padding: 0.7rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-family: inherit;
    }
    button {
      background: #d4a5a5;
      color: white;
      border: none;
      padding: 1rem;
      font-size: 1.1rem;
      border-radius: 10px;
      cursor: pointer;
      width: 100%;
      font-weight: 600;
    }
    button:hover { background: #c09090; }
    .terms {
      margin: 1.5rem 0;
      padding: 1.2rem;
      background: #fffdfb;
      border-radius: 10px;
      font-size: 0.95rem;
    }
    .terms h3 { margin-top: 0; }
    .alert {
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 8px;
      display: none;
    }
    .alert-success {
      background: #d4edda;
      color: #155724;
    }
    .alert-error {
      background: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body>
  <h1>Refer & Earn</h1>
  <p>Earn 10% of every successful order you refer! Just fill in the details below.</p>

  <div class="alert alert-success" id="successMsg">
    Thank you! Your referral has been submitted.
  </div>
  <div class="alert alert-error" id="errorMsg">
    Submission failed. Please check your inputs and try again.
  </div>

  <form id="referralForm">
    <div class="form-group">
      <label>Your Name (Referrer)*</label>
      <input type="text" name="referrerName" required>
    </div>
    <div class="form-group">
      <label>Your Email*</label>
      <input type="email" name="referrerEmail" required>
    </div>
    <div class="form-group">
      <label>Your Phone*</label>
      <input type="tel" name="referrerPhone" required pattern="[0-9]{10,15}">
    </div>

    <div class="form-group">
      <label>Referred Friend’s Name*</label>
      <input type="text" name="refereeName" required>
    </div>
    <div class="form-group">
      <label>Referred Friend’s Phone*</label>
      <input type="tel" name="refereePhone" required pattern="[0-9]{10,15}">
    </div>
    <div class="form-group">
      <label>Referred Friend’s Email (optional)</label>
      <input type="email" name="refereeEmail">
    </div>

    <div class="form-group">
      <label>Meesho Order ID*</label>
      <input type="text" name="orderId" placeholder="e.g., MEESH123456789" required>
    </div>
    <div class="form-group">
      <label>Order Screenshot Link*</label>
      <input type="url" name="screenshotLink" placeholder="Public link (Google Drive, etc.)" required>
    </div>
    <div class="form-group">
      <label>Additional Notes (Optional)</label>
      <textarea name="notes" rows="3"></textarea>
    </div>

    <div class="form-group">
      <label>
        <input type="checkbox" name="agreeTerms" required> 
        I agree to the <a href="#terms" style="color:#d4a5a5">Referral Terms</a>
      </label>
    </div>

    <button type="submit">Submit Referral</button>
  </form>

  <div class="terms" id="terms">
    <h3>Referral Terms</h3>
    <ul>
      <li>Earn 10% of order value (excl. shipping)</li>
      <li>Referee must be a first-time buyer</li>
      <li>Order must clear return window (7–10 days)</li>
      <li>Payout via UPI/bank weekly</li>
      <li>Fraud = disqualification</li>
    </ul>
  </div>

  <script>
    document.getElementById('referralForm').addEventListener('submit', function(e) {
      e.preventDefault();

      // ✅ REPLACE THIS URL WITH YOUR NEW DEPLOYMENT URL FROM APPS SCRIPT
      const scriptURL = 'https://script.google.com/macros/s/AKfycby7xeoyr2jN-xzpZAzzayDJzDEpDWpaNFsHZz5-GEjIXXJeZrKzvEL-9-z2R9Ul1ic8/exec';

      const form = e.target;
      const iframe = document.createElement('iframe');
      iframe.name = 'refFrame';
      iframe.style.display = 'none';
      document.body.appendChild(iframe);

      form.target = 'refFrame';
      form.action = scriptURL;
      form.method = 'POST';
      form.submit();

      // Show success (assume success; GAS returns "Success" on OK)
      document.getElementById('successMsg').style.display = 'block';
      document.getElementById('errorMsg').style.display = 'none';
      form.reset();

      setTimeout(() => {
        if (iframe.parentNode) iframe.parentNode.removeChild(iframe);
      }, 2000);
    });
  </script>
</body>
</html>